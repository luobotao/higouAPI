@(cartlist:List[vo.shoppingCart.ShoppingCartItemVO])(usr:User)(tfee:String)(alertmsg:String)(postmark:String)(postmarkurl:String)(waylist:List[vo.shoppingCart.ShoppingCartCategoryVO])(addrSign:WxSign)(prepid:String)@views.html.sheSaid.main{<title>购物车</title><script type="text/javascript" src="@assets.CdnAssets.urlForAPIPublic("javascripts/sheSaidJs/cityPanel/cityPanel.js")"></script><link rel="stylesheet" type="text/css" href="@assets.CdnAssets.urlForAPIPublic("stylesheets/sheSaidCSS/cityPanel/cityPanel.css")" media="all"><script src="@assets.CdnAssets.urlForAPIPublic("javascripts/sheSaidJs/alert.js")"></script><style> 			     			     /*需要整合的样式*/			.goods_info_name em a,.shop-top em{				display: inline-block;				width: 40px;				height: 20px;				border-radius: 6px;				vertical-align: middle;				line-height: 20px;				background: #ff374d;				border: 1px solid #ff374d;				color: #FFF;				text-align: center;				font-size: 12px;				margin: 0 10px;			}			.transparent {				display:none;                position: fixed;                top: 0;                left: 0;                right: 0;                bottom: 0;                background: rgba(0,0,0,.5);            } 			/*新加样式*/			.ico-scan,.ico_shop_cut,.ico_shop_add{				background:url(@assets.CdnAssets.urlForAPIPublic("images/H5/3ico.png")) no-repeat center top;                background-size:20px 150px;				}			.shop-top{				position: relative;				font-size:12px;				padding:8px 0;				}			.shop-top em{				vertical-align:0px;				}				.cont-b-t{				margin-top: 0px;				}			.shop-product .product{				overflow:hidden;                                position:relative;                border-bottom: 1px solid #E0E0E0;							}		    .cont{		        border:0;		    }			.shop-product-img{				padding-bottom:100px;				}				.shop-product-img img{				width:100%;				}			.shop-scan{				text-align:center;				border:1px solid #e0e0e0;				border-radius:3px;				box-shadow:0 0 3px #e0e0e0;				margin:10px;				padding:8px 0; 				}			    .ico-scan{				width:20px;				height:20px;				vertical-align:middle;				margin-right:5px;				background-position: 0 -14px;				}			.product_shop em{				float:left;				padding:0;				line-height:20px;				color:#797d82;				}			.product_shop p{				padding:0;				margin-left:110px;				}			.product_info{				bottom:12px;				}			.product_info em{				position:absolute;				bottom:0;				right:0;				line-height:16px;				}					.product_info-left{				float:left;				}				.ico_shop_cut,.ico_shop_add{				width:32px;				height:18px;				vertical-align:middle;				}			.ico_shop_cut{				background-position: 8px -38px;				}			.ico_shop_cut_h{				background-position: 8px -78px;				}					.ico_shop_add{					background-position: 8px -98px;							}			.ico_shop_add_h{				background-position: 8px -58px;					}				.product_info strong{				display:inline-block;				border:1px solid #85888d;				margin-right:6px;				height:26px;				border-radius:3px;				vertical-align:top;				}			.product_info b{				border-left:1px solid #85888d;				border-right:1px solid #85888d;				}			.btn-null{				padding:0 10px;				border:1px solid #85888d;				line-height:26px;				border-radius:3px;				font-size:12px;				}			.pop-shop{				display:none;			  position:fixed;			  top:50%;			  left:8%;			  width:84%;			  background:#faf9f8;			  border-radius:6px;			  text-align:center;			  margin-top:-160px;			  box-shadow:0 0 3px #88898f;			  		   }		  .pop-shop section{			  padding:35px;			  }			  .pop-shop a.btn-null{			  width:100%;			  padding:0;			  line-height:38px;			  margin-top:15px;			  font-size:16px;			  }			 .pop-shop p:first-child{			 padding-bottom:20px;			 }	  	  	    	  	  	  	        </style>}{<script charset="gb2312" language="javascript" type="text/javascript"><!--@if(alertmsg!=""){	_alert('@alertmsg');}//--></script><div class="container"><form name="form1" id="form1" method="post" action="/sheSaid/saveOrder">				<input type="hidden" id="uid" name="uid" value="@usr.getUid()" />		<div class="nav-top">               <p>购物车</p>               <i class="ico-return" onclick="javascript:window.location.href='@if(prepid==""){@assets.CdnAssets.H5_SHOPPING_URL("")}else{/H5/product?pid=@prepid}'"></i>               <i class="ico-basket" onclick="javascript:window.location.href='@assets.CdnAssets.H5_SHOPPING_URL("")'"></i>         </div>		@if(postmark!=""){		<div class="shop-top">              <em>包邮</em>              		保税区商品全场满128元包邮              <i class="ico_arrow_right" onclick="gomarkurl()"></i>       </div>       }        		 			@if(waylist!=null){		<div class="cont cont-b-t">        <!-- 			<div class="shop-scan" id="scanQRCode1">	                  <i class="ico-scan"></i>扫描二维码继续添加商品	        </div>		-->		 @for(c <- waylist){		 	<div class="shop-product">				<div class="shop-product-top shop-product-top-m">                           <span>@c.getFromsite()<em class="shipper"><img src="@c.getFromsiteimg()" alt=""></em></span>                           <em>@Html(c.getWayremark())</em>                 </div>                 @if(cartlist!=null){				@for(cart <- cartlist){  				@if(cart.fromsite==c.getFromsite()){					<div class="product">		                <div class="product_img"><img src="@cart.img" alt="@cart.title" /></div>					<div class="product_neme">@Html(cart.title)					<em id="cprice@cart.pid">￥@if(cart.rmbprice.indexOf(".")>=0){@(cart.rmbprice.toDouble)}else{@(cart.rmbprice.toInt)}</em>					</div>					<div class="product_info">						<input type="hidden" id="count@cart.pid" value="@cart.counts" />						<div class="product_info-left">						<strong>							<i class="ico_shop_cut@if(cart.counts.toInt>1){ ico_shop_cut_h}" id="cut_class@cart.pid" style="cursor:hand" onclick="@if(cart.counts.toInt>1){parsle('@cart.pid','@cart.rmbprice','@cart.limitcount','@{cart.counts.toInt}')}"></i>							<b id="parsnum@cart.pid">@cart.counts</b>							<i class="ico_shop_add@if(cart.counts.toInt>=cart.limitcount.toInt){ ico_shop_add_h}" id="add_class@cart.pid" style="cursor:hand" onclick="@if(cart.counts<cart.limitcount){add('@cart.pid','@cart.rmbprice','@cart.limitcount','@{cart.counts.toInt}')}"></i>						</strong>							<a href="javascript:;" class="btn btn-null" id="product-del" onclick="confirmdel('@cart.pid')">删除</a>								</div>									</div>				</div>			}    		}    	}    	</div>	}	     </div>    	<!--  		<div class="shop-product-img">              <img src="@assets.CdnAssets.urlForAPIPublic("images/H5/guarantee-1.png")">        </div>         -->    <div class="cont-h80"></div>   	<div class="cont fixed">		<div class="product_pay product_shop">			<em>合计:<b id="hjprice">￥@tfee</b><br>(不含运费)</em>			<p>				<a href="#" class="btn btn_finish" id="onsubreg" onclick="submito()"><span id="innertxt">去结算</span></a>			</p>		</div>	</div>	</div>    }else{    <div class="orderHungrg">               <img src="@assets.CdnAssets.urlForAPIPublic("images/H5/nocart.png")"><br>    <a href="javascript:;" class="btn-blank" onclick="javascript:window.location.href='@assets.CdnAssets.H5_SHOPPING_URL("")'">去看看</a>    </div> 	    <!-- <div class="shop-product-img">              <img src="@assets.CdnAssets.urlForAPIPublic("images/H5/guarantee-1.png")">        </div>-->   	    }</form>    <div class="transparent"></div>        <div class="pop-shop">        <input type="hidden" id="pids" value="0" />           <section>               <p>                 <img src='@assets.CdnAssets.urlForAPIPublic("images/H5/3ico-del.png")' class="pop-code-ico"><br>                 删除商品？               </p>                              <p>                  <a href="javascript:;" class="btn btn_finish" onclick="confirmdelete()">删除</a>                  <a href="javascript:;" class="btn btn-null" onclick="confirmcancel()">取消</a>               </p>           </section>        </div>}{<script type="text/javascript" src="@assets.CdnAssets.urlForAPIPublic("javascripts/sheSaidJs/noShareWX.js")"></script><script type="text/javascript"><!--function confirmdel(pid){	document.getElementById("pids").value=pid;	$('.transparent,.pop-shop').fadeIn();}function confirmcancel(){	$('.transparent,.pop-shop').fadeOut();}function confirmdelete(){	$('.transparent,.pop-shop').fadeOut();	var pids=document.getElementById("pids").value;	$.ajax({			type:"POST",			url:"/H5/shoppingCart_del",			data:{uid:'@usr.getUid()',pids:pids},			datatype:"json",			beforeSend:function(){},			success:function(data){				if(data.status=="1"){					//document.getElementById("hjprice").innerHTML="￥"+data.tfee;					window.location.href="/H5/orderprocart";					}else					_alert(data.msg);			},			complete:function(XZMLZZHttpRequest, textStatus){},			error:function(){				_alert("请检查网络！");			}		}); }			function submito(){		@if(cartlist!=null){			window.location.href="/H5/orderprocartcrm@if(addrSign!=null){?code=@addrSign.getCode()&state=@addrSign.getState()}";		}	}			 function add(v,p,limit,cnt){  	var nums=document.getElementById("count"+v).value; 	var endnum=(nums-1)+3-1; 	 	if(limit<2){		 $("#cut_class"+v).attr("class","ico_shop_cut");			 $("#add_class"+v).attr("class","ico_shop_add ico_shop_add_h");	 	 document.getElementById("add_class"+v).onclick="";	 	 document.getElementById("cut_class"+v).onclick="";	 	 	 } 	if(endnum>=limit){ 		endnum=limit; 		$("#add_class"+v).attr("class","ico_shop_add ico_shop_add_h"); 		document.getElementById("add_class"+v).onclick=""; 		if(endnum>1){ 			document.getElementById("cut_class"+v).onclick=function(){parsle(v,p,limit,cnt);}; 			$("#cut_class"+v).attr("class","ico_shop_cut ico_shop_cut_h"); 		}else{ 			$("#cut_class"+v).attr("class","ico_shop_cut"); 			document.getElementById("cut_class"+v).onclick=""; 		} 	}else{ 		$("#add_class"+v).attr("class","ico_shop_add"); 		document.getElementById("add_class"+v).onclick=function(){add(v,p,limit,cnt);}; 		 		if(endnum>1){ 			document.getElementById("cut_class"+v).onclick=function(){parsle(v,p,limit,cnt);}; 			$("#cut_class"+v).attr("class","ico_shop_cut ico_shop_cut_h"); 		}else{ 			$("#cut_class"+v).attr("class","ico_shop_cut"); 			document.getElementById("cut_class"+v).onclick=""; 		} 	} 	document.getElementById("parsnum"+v).innerHTML=endnum; 	document.getElementById("count"+v).value=endnum; 	document.getElementById("cprice"+v).innerHTML="￥"+(p)+""; 	var ps=0; 	 	var datastr=v+"_"+endnum+""; 	 		 $.ajax({ 				type:"POST", 				url:"/H5/shoppingCart_edit", 				data:{uid:'@usr.getUid()',datastr:datastr}, 				datatype:"json", 				beforeSend:function(){}, 				success:function(data){ 					if(data.status=="1"){ 						//alert(data.tfee); 						document.getElementById("hjprice").innerHTML="￥"+data.tfee; 					}else 						_alert(data.msg); 				}, 				complete:function(XZMLZZHttpRequest, textStatus){}, 				error:function(){ 					_alert("产品已售磬！"); 				} 			}); 	 } function parsle(v,p,limit,cnt){	 var nums=document.getElementById("count"+v).value;	 		 if(limit<2){		 $("#cut_class"+v).attr("class","ico_shop_cut");			 $("#add_class"+v).attr("class","ico_shop_add ico_shop_add_h");	 	 document.getElementById("add_class"+v).onclick="";	 	 document.getElementById("cut_class"+v).onclick="";	 	 	 }	 	var endnum=nums-1;	 	if(endnum>=limit){	 		endnum=limit;	 			 		$("#add_class"+v).attr("class","ico_shop_add ico_shop_add_h");	 		document.getElementById("add_class"+v).onclick="";	 		if(endnum>1){	 			document.getElementById("cut_class"+v).onclick=function(){parsle(v,p,limit,cnt);};	 			$("#cut_class"+v).attr("class","ico_shop_cut ico_shop_cut_h");	 		}else{	 			$("#cut_class"+v).attr("class","ico_shop_cut");	 			document.getElementById("cut_class"+v).onclick="";	 		}	 	}else{	 		$("#add_class"+v).attr("class","ico_shop_add");	 		document.getElementById("add_class"+v).onclick=function(){add(v,p,limit,cnt);};	 			 		if(endnum>1){	 			document.getElementById("cut_class"+v).onclick=function(){parsle(v,p,limit,cnt);};	 			$("#cut_class"+v).attr("class","ico_shop_cut ico_shop_cut_h");	 		}else{	 			$("#cut_class"+v).attr("class","ico_shop_cut");	 			document.getElementById("cut_class"+v).onclick="";	 		}	 	}	 	document.getElementById("parsnum"+v).innerHTML=endnum;	 	document.getElementById("count"+v).value=endnum;	 	document.getElementById("cprice"+v).innerHTML="￥"+(p)+"";	 	//cnt=0+cnt-1;		var datastr=v+"_"+endnum+"";		//alert(datastr+"parsle");	 $.ajax({			type:"POST",			url:"/H5/shoppingCart_edit",			data:{uid:'@usr.getUid()',datastr:datastr},			datatype:"json",			beforeSend:function(){},			success:function(data){				if(data.status=="1"){					//alert(data.tfee);					document.getElementById("hjprice").innerHTML="￥"+data.tfee;				}else					_alert(data.msg);			},			complete:function(XZMLZZHttpRequest, textStatus){},			error:function(){				_alert("产品已售磬！");			}		}); 	//document.getElementById("hjprice").innerHTML="￥"+(ppr+p*endnum-0+(ps-0)); }    //跳转邮费说明页面 function gomarkurl(){	 window.location.href='@postmarkurl'; }//--></script> }